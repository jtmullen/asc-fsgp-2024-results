name: Deploy to GitHub Pages

on:
  push:
    branches:
      - dev

jobs:
  github-pages:
    runs-on: ubuntu-latest
    permissions: 
        contents: write
    steps:
      - name: Checkout Source Repo
        uses: actions/checkout@v2
        
      - name: Cache Dependencies
        uses: actions/cache@v2
        with:
            path: vendor/bundle
            key: ${{ runner.os }}-gems-${{ hashFiles('**/Gemfile.lock') }}
            restore-keys: |
                ${{ runner.os }}-gems-
        
      - name: Build & Deploy
        uses:  jeffreytse/jekyll-deploy-action@v0.3.1
        with:
          provider: 'github'
          token: ${{ secrets.GITHUB_TOKEN }}
          jekyll_cfg: "_config_gh_pages.yml"
          pre_build_commands: 'git config --global http.version HTTP/1.1; git config --global http.postBuffer 52428800;'
